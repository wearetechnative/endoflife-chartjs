<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CALM - Release Lifecycle Charts</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.1.0/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1/dist/chartjs-adapter-moment.min.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="header">
      <div class="header-left">
        <img src="TechNative_logo.png" alt="Technative Logo" class="header-logo">
      </div>
      <div class="header-right">
        <h1 class="app-title"><a href="/" title="Cloud Anticipating Lifecycle Management">CALM</a></h1>
      </div>
    </div>
    <div class="content-wrapper">
      <div class="sidebar">
        <ul class="sidebar-menu" id="product-menu">
          <!-- Menu will be populated dynamically -->
        </ul>
      </div>
    <div class="main-content">
      <div class="container">
      <h1 class="chart-title"></h1>
      <div class="chart-container">
        <canvas id="horizontalBarChart"></canvas>
      </div>
      </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', async function() {
        // Fetch the products data
        const response = await fetch('products.json');
        const data = await response.json();
        
        // Build the menu
        const menu = document.getElementById('product-menu');
        
        data.categories.forEach(category => {
          // Add category header
          const categoryHeader = document.createElement('div');
          categoryHeader.className = 'category';
          categoryHeader.textContent = category.name;
          menu.appendChild(categoryHeader);
          
          // Add products for this category
          category.products.forEach((product, index) => {
            const item = document.createElement('li');
            item.setAttribute('data-product', product.id);
            item.textContent = product.name;
            
            // Set the first product of the first category as active by default
            if (index === 0 && menu.querySelector('.active') === null) {
              item.classList.add('active');
            }
            
            menu.appendChild(item);
          });
        });
        
        // Add click event listeners to menu items
        const menuItems = document.querySelectorAll('.sidebar-menu li');
        menuItems.forEach(item => {
          item.addEventListener('click', function() {
            // Remove active class from all menu items
            menuItems.forEach(mi => mi.classList.remove('active'));
            
            // Add active class to clicked item
            this.classList.add('active');
            
            // Get product from data attribute
            const product = this.getAttribute('data-product');
            
            // Call the chart function with the selected product
            chartForProduct(product);
          });
        });
        
        // Load the default product (first one)
        const defaultProduct = data.categories[0].products[0].id;
        chartForProduct(defaultProduct);
      });
    </script>
  </body>
</html>
